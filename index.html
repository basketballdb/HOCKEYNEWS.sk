<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Private Photo Feed</title>

<style>

/* =========================
   ROOT VARIABLES
========================= */

:root {
    --bg: #fafafa;
    --card: #ffffff;
    --text: #111;
    --border: #ddd;
    --accent: #0095f6;
}

body.dark {
    --bg: #121212;
    --card: #1e1e1e;
    --text: #f1f1f1;
    --border: #333;
    --accent: #4dabf7;
}

/* =========================
   GLOBAL
========================= */

* {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text);
    transition: 0.3s ease;
}

header {
    background: var(--card);
    padding: 18px;
    text-align: center;
    font-weight: 600;
    font-size: 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.toggle-dark {
    cursor: pointer;
    font-size: 14px;
    padding: 6px 10px;
    border-radius: 20px;
    border: 1px solid var(--border);
}

/* =========================
   CONTAINER
========================= */

.container {
    max-width: 950px;
    margin: auto;
    padding: 20px;
}

/* =========================
   POST FORM
========================= */

.post-form {
    background: var(--card);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid var(--border);
    margin-bottom: 30px;
}

textarea {
    width: 100%;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px;
    resize: none;
    margin-bottom: 12px;
    background: transparent;
    color: var(--text);
}

input[type="file"] {
    margin-bottom: 12px;
}

button {
    background: var(--accent);
    border: none;
    padding: 8px 14px;
    color: white;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
}

button:hover {
    opacity: 0.9;
}

/* =========================
   FEED GRID
========================= */

.feed {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 20px;
}

.post {
    position: relative;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.post:hover {
    transform: scale(1.02);
}

.post img {
    width: 100%;
    height: 260px;
    object-fit: cover;
    border-radius: 12px;
}

.overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.4);
    border-radius: 12px;
    opacity: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    font-size: 18px;
    gap: 15px;
    transition: 0.2s;
}

.post:hover .overlay {
    opacity: 1;
}

/* =========================
   MODAL
========================= */

.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding: 20px;
    z-index: 999;
}

.modal-content {
    background: var(--card);
    max-width: 900px;
    width: 100%;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: fadeIn 0.3s ease;
}

.modal-image {
    text-align: center;
    background: black;
}

.modal-image img {
    max-height: 500px;
    max-width: 100%;
}

.modal-info {
    padding: 15px;
}

.modal-caption {
    margin-bottom: 10px;
    font-size: 14px;
}

.modal-date {
    font-size: 12px;
    color: gray;
    margin-bottom: 10px;
}

.modal-controls {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
}

.control-left,
.control-right {
    display: flex;
    gap: 8px;
}

.modal button {
    background: var(--accent);
}

/* =========================
   ANIMATIONS
========================= */

@keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

/* =========================
   RESPONSIVE
========================= */

@media(max-width: 700px){
    .modal-content {
        flex-direction: column;
    }
}

</style>
</head>
<body>

<header>
    <div>My Private Photo Feed</div>
    <div class="toggle-dark" onclick="toggleDark()">Toggle Mode</div>
</header>

<div class="container">

<div class="post-form">
    <textarea id="caption" placeholder="Write a caption..."></textarea>
    <input type="file" id="images" multiple accept="image/*">
    <button onclick="createPost()">Create Post</button>
</div>

<div class="feed" id="feed"></div>

</div>

<div class="modal" id="modal">
    <div class="modal-content">
        <div class="modal-image">
            <img id="modalImage">
        </div>
        <div class="modal-info">
            <div class="modal-caption" id="modalCaption"></div>
            <div class="modal-date" id="modalDate"></div>

            <div class="modal-controls">
                <div class="control-left">
                    <button onclick="prevImage()">‚óÄ</button>
                    <button onclick="nextImage()">‚ñ∂</button>
                </div>

                <div class="control-right">
                    <button onclick="likePost()">‚ù§Ô∏è Like</button>
                    <button onclick="deletePost()">üóë Delete</button>
                    <button onclick="closeModal()">Close</button>
                </div>
            </div>

            <div id="imageCounter" style="margin-top:8px;font-size:12px;"></div>

        </div>
    </div>
</div>

<script>

/* =========================
   STATE
========================= */

let posts = JSON.parse(localStorage.getItem("posts")) || [];
let currentPostIndex = 0;
let currentImageIndex = 0;

/* =========================
   STORAGE
========================= */

function savePosts() {
    localStorage.setItem("posts", JSON.stringify(posts));
}

/* =========================
   CREATE POST
========================= */

function createPost() {
    const caption = document.getElementById("caption").value;
    const files = document.getElementById("images").files;

    if (files.length === 0) return;

    const images = [];
    let loaded = 0;

    for (let file of files) {
        const reader = new FileReader();
        reader.onload = function(e) {
            images.push(e.target.result);
            loaded++;
            if (loaded === files.length) {
                posts.unshift({
                    caption,
                    images,
                    date: new Date().toLocaleString(),
                    likes: 0
                });
                savePosts();
                renderFeed();
                document.getElementById("caption").value = "";
                document.getElementById("images").value = "";
            }
        };
        reader.readAsDataURL(file);
    }
}

/* =========================
   RENDER FEED
========================= */

function renderFeed() {
    const feed = document.getElementById("feed");
    feed.innerHTML = "";

    posts.forEach((post, index) => {
        const div = document.createElement("div");
        div.className = "post";
        div.onclick = () => openModal(index);

        const img = document.createElement("img");
        img.src = post.images[0];
        div.appendChild(img);

        const overlay = document.createElement("div");
        overlay.className = "overlay";
        overlay.innerHTML = `‚ù§Ô∏è ${post.likes} ${post.images.length > 1 ? "üìö" : ""}`;
        div.appendChild(overlay);

        feed.appendChild(div);
    });
}

/* =========================
   MODAL
========================= */

function openModal(index) {
    currentPostIndex = index;
    currentImageIndex = 0;
    document.getElementById("modal").style.display = "flex";
    updateModal();
}

function updateModal() {
    const post = posts[currentPostIndex];
    document.getElementById("modalImage").src =
        post.images[currentImageIndex];
    document.getElementById("modalCaption").innerText =
        post.caption || "(No caption)";
    document.getElementById("modalDate").innerText =
        post.date;
    document.getElementById("imageCounter").innerText =
        `Image ${currentImageIndex + 1} of ${post.images.length}`;
}

function closeModal() {
    document.getElementById("modal").style.display = "none";
}

/* =========================
   NAVIGATION
========================= */

function nextImage() {
    if (currentImageIndex < posts[currentPostIndex].images.length - 1) {
        currentImageIndex++;
        updateModal();
    }
}

function prevImage() {
    if (currentImageIndex > 0) {
        currentImageIndex--;
        updateModal();
    }
}

/* =========================
   LIKE
========================= */

function likePost() {
    posts[currentPostIndex].likes++;
    savePosts();
    updateModal();
    renderFeed();
}

/* =========================
   DELETE
========================= */

function deletePost() {
    if (!confirm("Delete this post?")) return;
    posts.splice(currentPostIndex, 1);
    savePosts();
    closeModal();
    renderFeed();
}

/* =========================
   DARK MODE
========================= */

function toggleDark() {
    document.body.classList.toggle("dark");
}

/* =========================
   KEYBOARD SUPPORT
========================= */

document.addEventListener("keydown", function(e){
    if (document.getElementById("modal").style.display === "flex") {
        if (e.key === "ArrowRight") nextImage();
        if (e.key === "ArrowLeft") prevImage();
        if (e.key === "Escape") closeModal();
    }
});

renderFeed();

</script>

</body>
</html>
